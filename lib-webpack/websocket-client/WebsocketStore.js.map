{"version":3,"sources":["../../src/websocket-client/WebsocketStore.js"],"names":[],"mappings":";;;;;;;;AAAA,OAAO,aAAP,MAA0B,wBAA1B;AACA,OAAO,eAAP,MAA4B,mBAA5B;;IAOqB,c;;;AAGjB,4BAAY,SAAZ,EAA4C,QAA5C,EAA8D;AAAA;;AAAA,sGACpD,SADoD;;AAAA,cAF9D,OAE8D,GAFpD,KAEoD;;;AAG1D,YAAI,CAAC,QAAL,EAAe;AACX,kBAAM,IAAI,KAAJ,yBAAgC,QAAhC,OAAN;AACH;;AAED,cAAK,QAAL,GAAgB,QAAhB;AAP0D;AAQ7D;;;;6BAEI,I,EAAe;AAChB,gBAAI,CAAC,KAAK,UAAL,CAAgB,WAAhB,EAAL,EAAoC;AAChC,sBAAM,IAAI,KAAJ,CAAU,4BAAV,CAAN;AACH;;AAHe,8CAAN,IAAM;AAAN,oBAAM;AAAA;;AAIhB,mBAAO,KAAK,UAAL,CAAgB,IAAhB,CAAqB,MAArB,EAA6B,EAAE,UAAF,EAAQ,UAAU,KAAK,QAAvB,EAA7B,EAAgE,IAAhE,CAAP;AACH;;;kCAES,M,EAAuC;AAC7C,mBAAO,KAAK,IAAL,CAAU,WAAV,EAAuB,MAAvB,CAAP;AACH;;;kCAES,M,EAAuC;AAC7C,mBAAO,KAAK,IAAL,CAAU,WAAV,EAAuB,MAAvB,CAAP;AACH;;;sCAEa,O,EAAsD;AAChE,mBAAO,KAAK,IAAL,CAAU,eAAV,EAA2B,OAA3B,CAAP;AACH;;;2CAEkB,G,EAAU,a,EAAgC;AACzD,mBAAO,KAAK,IAAL,CAAU,oBAAV,EAAgC,GAAhC,EAAqC,aAArC,CAAP;AACH;;;yCAEgB,M,EAAmB,a,EAA2C;AAC3E,mBAAO,KAAK,IAAL,CAAU,kBAAV,EAA8B,MAA9B,EAAsC,aAAtC,CAAP;AACH;;;0CAEiB,Q,EAAU,a,EAAgC;AACxD,mBAAO,KAAK,IAAL,CAAU,mBAAV,EAA+B,QAA/B,EAAyC,aAAzC,CAAP;AACH;;;oCAEW,G,EAAmB;AAC3B,mBAAO,KAAK,IAAL,CAAU,aAAV,EAAyB,GAAzB,CAAP;AACH;;;kCAES,M,EAA4B;AAClC,mBAAO,KAAK,IAAL,CAAU,WAAV,EAAuB,MAAvB,CAAP;AACH;;;+BAEM,Q,EAAmB,I,EAAoD;AAC1E,mBAAO,QAAQ,OAAR,CAAgB,IAAI,eAAJ,CAAoB,IAApB,EAA0B,EAAE,kBAAF,EAAY,UAAZ,EAA1B,CAAhB,CAAP;AACH;;;kCAES,G,EAAU;AAChB,mBAAO,KAAK,OAAL,CAAa,EAAE,KAAK,GAAP,EAAb,CAAP;AACH;;;gCAEO,Q,EAAkB,I,EAAgC;AACtD,mBAAO,KAAK,IAAL,CAAU,SAAV,EAAqB,QAArB,EAA+B,IAA/B,CAAP;AACH;;;;EA9DkD,a;;eAAlC,c","file":"WebsocketStore.js","sourcesContent":["import AbstractStore from '../store/AbstractStore';\nimport WebsocketCursor from './WebsocketCursor';\n\ntype WebsocketConnection = {\n    emit: Function,\n    isConnected: Function,\n}\n\nexport default class WebsocketStore<ModelType> extends AbstractStore<WebsocketConnection> {\n    keyPath = '_id';\n\n    constructor(websocket: WebsocketConnection, restName: string) {\n        super(websocket);\n\n        if (!restName) {\n            throw new Error(`Invalid restName: \"${restName}\"`);\n        }\n\n        this.restName = restName;\n    }\n\n    emit(type, ...args) {\n        if (!this.connection.isConnected()) {\n            throw new Error('Websocket is not connected');\n        }\n        return this.connection.emit('rest', { type, restName: this.restName }, args);\n    }\n\n    insertOne(object: ModelType): Promise<ModelType> {\n        return this.emit('insertOne', object);\n    }\n\n    updateOne(object: ModelType): Promise<ModelType> {\n        return this.emit('updateOne', object);\n    }\n\n    updateSeveral(objects: Array<ModelType>): Promise<Array<ModelType>> {\n        return this.emit('updateSeveral', objects);\n    }\n\n    partialUpdateByKey(key: any, partialUpdate: Object): Promise {\n        return this.emit('partialUpdateByKey', key, partialUpdate);\n    }\n\n    partialUpdateOne(object: ModelType, partialUpdate: Object): Promise<ModelType> {\n        return this.emit('partialUpdateOne', object, partialUpdate);\n    }\n\n    partialUpdateMany(criteria, partialUpdate: Object): Promise {\n        return this.emit('partialUpdateMany', criteria, partialUpdate);\n    }\n\n    deleteByKey(key: any): Promise {\n        return this.emit('deleteByKey', key);\n    }\n\n    deleteOne(object: ModelType): Promise {\n        return this.emit('deleteOne', object);\n    }\n\n    cursor(criteria: ?Object, sort: ?Object): Promise<WebsocketCursor<ModelType>> {\n        return Promise.resolve(new WebsocketCursor(this, { criteria, sort }));\n    }\n\n    findByKey(key: any) {\n        return this.findOne({ _id: key });\n    }\n\n    findOne(criteria: Object, sort: ?Object): Promise<Object> {\n        return this.emit('findOne', criteria, sort);\n    }\n}\n"]}