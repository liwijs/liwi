{"version":3,"sources":["../../src/store/AbstractCursor.js"],"names":["AbstractCursor","store","_store","Error","next","then","result","applyLimit","findByKey","key","deleteByKey","callback","forEachKeys","Symbol","iterator","keysIterator","keyPromise"],"mappings":";;;;;;;;IAAqBA,c;AAGnB,0BAAYC,KAAZ,EAA0B;AAAA,YAAdA,KAAc;;AAAA;;AACxB,SAAKC,MAAL,GAAcD,KAAd;AACD;;;;4BAMO;AACN,YAAM,IAAIE,KAAJ,CAAU,gCAAV,CAAN;AACD;;;2BAEoB;AAAA;AACnB,cAAM,IAAIA,KAAJ,CAAU,+BAAV,CAAN;AADmB;AAEpB;;;iCAE0B;AAAA;AAAA;;AACzB,eAAO,KAAKC,IAAL,GAAYC,IAAZ,CAAiB;AAAA,iBAAM,MAAKC,MAAL,EAAN;AAAA,SAAjB,CAAP;AADyB;AAE1B;;;4BAEgC;AAAA;AAC/B,cAAM,IAAIH,KAAJ,CAAU,gCAAV,CAAN;AAD+B;AAEhC;;;4BAEkC;AAAA,UAA7BI,UAA6B,uEAAP,KAAO;;AAAA,cAA7BA,UAA6B;;AACjC,YAAM,IAAIJ,KAAJ,CAAU,gCAAV,CAAN;AACD;;;6BAE4B;AAAA;AAC3B,eAAO,KAAKF,KAAL,CAAWO,SAAX,CAAqB,KAAKC,GAA1B,CAAP;AAD2B;AAE5B;;;8BAEiB;AAAA;AAChB,eAAO,KAAKR,KAAL,CAAWS,WAAX,CAAuB,KAAKD,GAA5B,CAAP;AADgB;AAEjB;;;gCAEiBE,Q,EAA6B;AAAA,cAA7BA,QAA6B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAEzB,KAAKP,IAAL,EAFyB;;AAAA;AAErCK,mBAFqC;;AAAA,oBAGtCA,GAHsC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,uBAKrCE,SAASF,GAAT,CALqC;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAO9C;;;4BAEOE,Q,EAAmB;AAAA;AAAA;;AACzB,eAAO,KAAKC,WAAL,CAAiB;AAAA,iBAAM,OAAKN,MAAL,GAAcD,IAAd,CAAmB;AAAA,mBAAUM,SAASL,MAAT,CAAV;AAAA,WAAnB,CAAN;AAAA,SAAjB,CAAP;AADyB;AAE1B;;;;;;;;;;;;;;qBAIS,KAAKF,IAAL,E;;;;;;;;;;;;;;SAIPS,OAAOC,Q;;;;;;;;;;AACR;;;;;0BACuB,KAAKC,YAAL,E;;;;;;;;AAAdC,wB;;qBACDA,WAAWX,IAAX,CAAgB;AAAA,uBAAOI,OAAO,OAAKH,MAAL,EAAd;AAAA,eAAhB,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIR;AACA;;;;;;;;;;;;;;;;;wBA3DiB;AAAA;AACjB,eAAO,KAAKJ,MAAZ;AADiB;AAElB;;;;;;eATkBF,c","file":"AbstractCursor.js","sourcesContent":["export default class AbstractCursor<Store, ModelType> {\n  key: any;\n\n  constructor(store: Store) {\n    this._store = store;\n  }\n\n  get store(): Store {\n    return this._store;\n  }\n\n  close() {\n    throw new Error('close() missing implementation');\n  }\n\n  next(): Promise<any> {\n    throw new Error('next() missing implementation');\n  }\n\n  nextResult(): Promise<any> {\n    return this.next().then(() => this.result());\n  }\n\n  limit(newLimit: number): Promise {\n    throw new Error('limit() missing implementation');\n  }\n\n  count(applyLimit: boolean = false) {\n    throw new Error('count() missing implementation');\n  }\n\n  result(): Promise<ModelType> {\n    return this.store.findByKey(this.key);\n  }\n\n  delete(): Promise {\n    return this.store.deleteByKey(this.key);\n  }\n\n  async forEachKeys(callback: Function): Promise {\n    while (true) {\n      const key = await this.next();\n      if (!key) return;\n\n      await callback(key);\n    }\n  }\n\n  forEach(callback): Promise {\n    return this.forEachKeys(() => this.result().then(result => callback(result)));\n  }\n\n  * keysIterator() {\n    while (true) {\n      yield this.next();\n    }\n  }\n\n  * [Symbol.iterator]() {\n    // eslint-disable-next-line no-restricted-syntax\n    for (let keyPromise of this.keysIterator()) {\n      yield keyPromise.then(key => key && this.result());\n    }\n  }\n\n    // TODO Symbol.asyncIterator, https://phabricator.babeljs.io/T7356\n    /*\n    async *keysAsyncIterator() {\n        while (true) {\n             const key = await this.next();\n             if (!key) return;\n\n             yield key;\n        }\n     }\n\n     async *[Symbol.asyncIterator] {\n        for await (let key of this.keysAsyncIterator()) {\n            yield await this.result();\n        }\n     }\n     */\n}\n"]}