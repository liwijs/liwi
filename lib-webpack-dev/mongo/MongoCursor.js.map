{"version":3,"sources":["../../src/mongo/MongoCursor.js"],"names":["Cursor","MongoStore","AbstractCursor","MongoCursor","store","cursor","_cursor","count","skip","next","then","value","_result","key","_id","newLimit","limit","Promise","resolve","applyLimit","close","_store","undefined","toArray"],"mappings":";;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,oBAAnB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,cAAP,MAA2B,yBAA3B;;IAEqBC,W;;;AACnB,uBAAYC,KAAZ,EAA8BC,MAA9B,EAA6C;AAAA,YAAjCD,KAAiC,EAA3BH,UAA2B;;AAAA,YAAfI,MAAe,EAARL,MAAQ;;AAAA;;AAAA,0HACrCI,KADqC;;AAE3C,UAAKE,OAAL,GAAeD,MAAf;AAF2C;AAG5C;;;;4BAEOE,K,EAAmB;AAAA,cAAnBA,KAAmB;;AAAA;AACzB,aAAKD,OAAL,CAAaE,IAAb,CAAkBD,KAAlB;AADyB;AAE1B;;;2BAEmB;AAAA;AAAA;;AAClB,eAAO,KAAKD,OAAL,CAAaG,IAAb,GACJC,IADI,CACC,UAACC,KAAD,EAAW;AACf,iBAAKC,OAAL,GAAeD,KAAf;AACA,iBAAKE,GAAL,GAAWF,SAASA,MAAMG,GAA1B;AACA,iBAAO,OAAKD,GAAZ;AACD,SALI,CAAP;AADkB;AAOnB;;;0BAEKE,Q,EAAyB;AAAA,cAAzBA,QAAyB;;AAAA;AAC7B,aAAKT,OAAL,CAAaU,KAAb,CAAmBD,QAAnB;AACA,eAAOE,QAAQC,OAAR,CAAgB,IAAhB,CAAP;AAF6B;AAG9B;;;4BAEiC;AAAA,UAA5BC,UAA4B,uEAAP,KAAO;;AAAA,cAA5BA,UAA4B;;AAChC,aAAO,KAAKb,OAAL,CAAaC,KAAb,CAAmBY,UAAnB,CAAP;AACD;;;6BAEQ;AACP,aAAOF,QAAQC,OAAR,CAAgB,KAAKN,OAArB,CAAP;AACD;;;4BAEO;AACN,UAAI,KAAKN,OAAT,EAAkB;AAChB,aAAKA,OAAL,CAAac,KAAb;AACA,aAAKd,OAAL,GAAe,KAAKe,MAAL,GAAc,KAAKT,OAAL,GAAeU,SAA5C;AACD;;AAED,aAAOL,QAAQC,OAAR,EAAP;AACD;;;8BAEmC;AAAA;AAClC,eAAO,KAAKZ,OAAL,CAAaiB,OAAb,EAAP;AADkC;AAEnC;;;;EA3CiDrB,c;;eAA/BC,W","file":"MongoCursor.js","sourcesContent":["import Cursor from 'mongodb/lib/cursor';\nimport MongoStore from './MongoStore';\nimport AbstractCursor from '../store/AbstractCursor';\n\nexport default class MongoCursor<ModelType> extends AbstractCursor<MongoStore, ModelType> {\n  constructor(store:MongoStore, cursor:Cursor) {\n    super(store);\n    this._cursor = cursor;\n  }\n\n  advance(count:number):void {\n    this._cursor.skip(count);\n  }\n\n  next():Promise<any> {\n    return this._cursor.next()\n      .then((value) => {\n        this._result = value;\n        this.key = value && value._id;\n        return this.key;\n      });\n  }\n\n  limit(newLimit:number):Promise {\n    this._cursor.limit(newLimit);\n    return Promise.resolve(this);\n  }\n\n  count(applyLimit:boolean = false) {\n    return this._cursor.count(applyLimit);\n  }\n\n  result() {\n    return Promise.resolve(this._result);\n  }\n\n  close() {\n    if (this._cursor) {\n      this._cursor.close();\n      this._cursor = this._store = this._result = undefined;\n    }\n\n    return Promise.resolve();\n  }\n\n  toArray():Promise<Array<ModelType>> {\n    return this._cursor.toArray();\n  }\n}\n"]}