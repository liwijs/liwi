{"version":3,"sources":["../../src/store/AbstractCursor.js"],"names":[],"mappings":";;;;;;;;AAAe,MAAM,cAAN,CAAwC;;AAGnD,gBAAY,KAAZ,EAA0B;AACtB,aAAK,MAAL,GAAc,KAAd;AACH;;AAED,QAAI,KAAJ,GAAmB;AACf,eAAO,KAAK,MAAZ;AACH;;AAED,YAAQ;AACJ,cAAM,IAAI,KAAJ,CAAU,gCAAV,CAAN;AACH;;AAED,WAAqB;AACjB,cAAM,IAAI,KAAJ,CAAU,+BAAV,CAAN;AACH;;AAED,iBAA2B;AAAA;AAAA,kCAAb,OAAa;AAAA;AAAA;;AAAA;AAAA;;AAAA,qBAChB,KAAK,IAAL,GAAY,IAAZ,CAAiB;AAAA,mBAAM,KAAK,MAAL,EAAN;AAAA,SAAjB,CADgB;AAE1B;;AAED,UAAM,QAAN,EAAiC;AAAA,qBAA3B,QAA2B;AAAA,4HAA3B,QAA2B;AAAA;;AAC7B,cAAM,IAAI,KAAJ,CAAU,gCAAV,CAAN;AACH;;AAED,YAAmC;AAAA,YAA7B,UAA6B,yDAAP,KAAO;;AAAA,qBAA7B,UAA6B;AAAA,4HAA7B,UAA6B;AAAA;;AAC/B,cAAM,IAAI,KAAJ,CAAU,gCAAV,CAAN;AACH;;AAED,aAA8B;AAAA;AAAA,kCAApB,OAAoB;AAAA;AAAA;;AAAA;AAAA;;AAAA,qBACnB,KAAK,KAAL,CAAW,SAAX,CAAqB,KAAK,GAA1B,CADmB;AAE7B;;AAED,aAAkB;AAAA;AAAA,kCAAR,OAAQ;AAAA;AAAA;;AAAA;AAAA;;AAAA,qBACP,KAAK,KAAL,CAAW,WAAX,CAAuB,KAAK,GAA5B,CADO;AAEjB;;AAEK,eAAN,CAAkB,QAAlB,EAA+C;AAAA;;AAAA;AAAA,yBAA7B,QAA6B;AAAA,kIAA7B,QAA6B;AAAA;;AAC3C,mBAAO,IAAP,EAAa;AACT,sBAAM,MAAM,MAAM,MAAK,IAAL,EAAlB;AACA,oBAAI,CAAC,GAAL,EAAU;;AAEV,sBAAM,SAAS,GAAT,CAAN;AACH;AAN0C;AAO9C;;AAED,YAAQ,QAAR,EAA2B;AAAA;AAAA,kCAAR,OAAQ;AAAA;AAAA;;AAAA;AAAA;;AAAA,qBAChB,KAAK,WAAL,CAAiB;AAAA,mBAAM,KAAK,MAAL,GAAc,IAAd,CAAmB;AAAA,uBAAU,SAAS,MAAT,CAAV;AAAA,aAAnB,CAAN;AAAA,SAAjB,CADgB;AAE1B;;AAED,KAAC,YAAD,GAAgB;AACZ,eAAO,IAAP,EAAa;AACT,kBAAM,KAAK,IAAL,EAAN;AACH;AACJ;;AAED,MAAE,OAAO,QAAT,IAAqB;AAAA,wBACM,KAAK,YAAL,EADN;;AAAA;AAAA;AAAA;;AACjB,aAAK,IAAI,UAAT,mBAA4C;AAAA;;AACxC,kBAAM,WAAW,IAAX,CAAgB;AAAA,uBAAO,OAAO,KAAK,MAAL,EAAd;AAAA,aAAhB,CAAN;AACH;AACJ;;;;;;;;;;;;;;;;;AA9DkD;kBAAlC,c","file":"AbstractCursor.js","sourcesContent":["export default class AbstractCursor<Store, ObjectType> {\n    key: any;\n\n    constructor(store: Store) {\n        this._store = store;\n    }\n\n    get store(): Store {\n        return this._store;\n    }\n\n    close() {\n        throw new Error('close() missing implementation');\n    }\n\n    next(): Promise<any> {\n        throw new Error('next() missing implementation');\n    }\n\n    nextResult(): Promise<any> {\n        return this.next().then(() => this.result());\n    }\n\n    limit(newLimit: number): Promise {\n        throw new Error('limit() missing implementation');\n    }\n\n    count(applyLimit: boolean = false) {\n        throw new Error('count() missing implementation');\n    }\n\n    result(): Promise<ObjectType> {\n        return this.store.findByKey(this.key);\n    }\n\n    delete(): Promise {\n        return this.store.deleteByKey(this.key);\n    }\n\n    async forEachKeys(callback: Function): Promise {\n        while (true) {\n            const key = await this.next();\n            if (!key) return;\n\n            await callback(key);\n        }\n    }\n\n    forEach(callback): Promise {\n        return this.forEachKeys(() => this.result().then(result => callback(result)));\n    }\n\n    *keysIterator() {\n        while (true) {\n            yield this.next();\n        }\n    }\n\n    *[Symbol.iterator]() {\n        for (let keyPromise of this.keysIterator()) {\n            yield keyPromise.then(key => key && this.result());\n        }\n    }\n\n    // TODO Symbol.asyncIterator, https://phabricator.babeljs.io/T7356\n    /*\n    async *keysAsyncIterator() {\n        while (true) {\n             const key = await this.next();\n             if (!key) return;\n\n             yield key;\n        }\n     }\n\n     async *[Symbol.asyncIterator] {\n        for await (let key of this.keysAsyncIterator()) {\n            yield await this.result();\n        }\n     }\n     */\n}\n"]}