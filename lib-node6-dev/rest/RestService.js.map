{"version":3,"sources":["../../src/rest/RestService.js"],"names":["RestService","constructor","restResources","addRestResource","key","restResource","set","get","Error","createCursor","connectedUser","criteria","sort","limit","cursor","store"],"mappings":";;;;;;;AAAA;;;;;;;;;;;;IAEqBA,W,GAAN,MAAkB;AAC/BC,cAAYC,aAAZ,EAA6C;AAAA,6BAApB,iCAAM,8BAAN,EAAc,2BAAd,CAAoB;;AAAA,4FAC3C,KAAKA,aAAL,GAAqBA,aADsB;AAE5C;;AAEDC,kBAAgBC,GAAhB,EAA6BC,YAA7B,EAA2C;AAAA,mBAAxB,8BAAwB;;AAAA,8DACzC,KAAKH,aAAL,CAAmBI,GAAnB,CAAuBF,GAAvB,EAA4BC,YAA5B,CADyC;AAE1C;;AAEDE,MAAIH,GAAJ,EAAiB;AAAA,oBAAV,8BAAU;;AAAA;;AACf,UAAMC,eAAe,KAAKH,aAAL,CAAmBK,GAAnB,CAAuBH,GAAvB,CAArB;AACA,QAAI,CAACC,YAAL,EAAmB,MAAM,IAAIG,KAAJ,CAAW,2BAA0BJ,GAAI,GAAzC,CAAN;AACnB,WAAOC,YAAP;AACD;;AAEKI,cAAN,CACEJ,YADF,EAEEK,aAFF,QAIW;AAAA;AAAA,+BAFI,+BAAG,8BAAH,CAEJ;;AAAA;;AAAA;;AAAA,UADT,EAAEC,QAAF,EAAYC,IAAZ,EAAkBC,KAAlB,EACS,GADgB,6BAAI,2CAAU,+BAAC,8BAAD,CAAV,CAAJ,EAAuB,uCAAM,+BAAC,8BAAD,CAAN,CAAvB,EAAsC,wCAAO,+BAAC,8BAAD,CAAP,CAAtC,CAChB;;AAETF,iBAAWN,aAAaM,QAAb,CAAsBD,aAAtB,EAAqCC,cAArC,CAFF,EAGTC,OAAOP,aAAaO,IAAb,CAAkBF,aAAlB,EAAiCE,IAAjC,CAHE;;AAIT,YAAME,SAAS,MAAMT,aAAaU,KAAb,CAAmBD,MAAnB,CAA0BH,QAA1B,EAAoCC,IAApC,CAArB;;AAGA,aAFAC,QAAQR,aAAaQ,KAAb,CAAmBA,KAAnB,CAER,EADIA,KACJ,IADWC,OAAOD,KAAP,CAAaH,aAAb,EAA4BG,KAA5B,CACX,qBAAO,yBAAeR,YAAf,EAA6BK,aAA7B,EAA4CI,MAA5C,CAAP;AAPS;AAQV;AA3B8B,C;kBAAZd,W","file":"RestService.js","sourcesContent":["import RestCursor from './RestCursor';\n\nexport default class RestService {\n  constructor(restResources: Map<string, any>) {\n    this.restResources = restResources;\n  }\n\n  addRestResource(key: string, restResource) {\n    this.restResources.set(key, restResource);\n  }\n\n  get(key: string) {\n    const restResource = this.restResources.get(key);\n    if (!restResource) throw new Error(`Invalid rest resource: \"${key}\"`);\n    return restResource;\n  }\n\n  async createCursor(\n    restResource,\n    connectedUser: ?Object,\n    { criteria, sort, limit }: { criteria: ?Object, sort: ?Object, limit: ?number },\n  ): Promise {\n    // TODO: restResource.query(connectedUser, criteria || {}, sort).cursor()\n    criteria = restResource.criteria(connectedUser, criteria || {});\n    sort = restResource.sort(connectedUser, sort);\n    const cursor = await restResource.store.cursor(criteria, sort);\n    limit = restResource.limit(limit);\n    if (limit) cursor.limit(connectedUser, limit);\n    return new RestCursor(restResource, connectedUser, cursor);\n  }\n}\n"]}