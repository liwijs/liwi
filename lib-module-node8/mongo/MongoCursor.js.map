{"version":3,"sources":["../../src/mongo/MongoCursor.js"],"names":["AbstractCursor","MongoCursor","constructor","store","cursor","_cursor","advance","count","skip","next","then","value","_result","key","_id","limit","newLimit","Promise","resolve","applyLimit","result","close","_store","toArray"],"mappings":";AAEA,OAAOA,cAAP,MAA2B,yBAA3B;IAGqBC,W,GAAN,cAA0BD,cAA1B,CAAqD;AAClEE,cAAYC,KAAZ,EAA+BC,MAA/B,EAA+C;AAC7C,UAAMD,KAAN,CAD6C,EAE7C,KAAKE,OAAL,GAAeD,MAF8B;AAG9C;;AAEDE,UAAQC,KAAR,EAA6B;AAC3B,SAAKF,OAAL,CAAaG,IAAb,CAAkBD,KAAlB,CAD2B;AAE5B;;AAEDE,SAAqB;AACnB,WAAO,KAAKJ,OAAL,CAAaI,IAAb,GAAoBC,IAApB,CAAyBC,UAC9B,KAAKC,OAAL,GAAeD,KADe,EAE9B,KAAKE,GAAL,GAAWF,SAASA,MAAMG,GAFI,EAGvB,KAAKD,GAHkB,CAAzB,CAAP;AAKD;;AAEDE,QAAMC,QAAN,EAAiC;AAE/B,WADA,KAAKX,OAAL,CAAaU,KAAb,CAAmBC,QAAnB,CACA,EAAOC,QAAQC,OAAR,CAAgB,IAAhB,CAAP;AACD;;AAEDX,QAAMY,aAAsB,KAA5B,EAAmC;AACjC,WAAO,KAAKd,OAAL,CAAaE,KAAb,CAAmBY,UAAnB,CAAP;AACD;;AAEDC,WAAS;AACP,WAAOH,QAAQC,OAAR,CAAgB,KAAKN,OAArB,CAAP;AACD;;AAEDS,UAAQ;;AAQN,WAPI,KAAKhB,OAOT,KANE,KAAKA,OAAL,CAAagB,KAAb,EAMF,EALE,KAAKhB,OAAL,SAKF,EAJE,KAAKiB,MAAL,SAIF,EAHE,KAAKV,OAAL,SAGF,GAAOK,QAAQC,OAAR,EAAP;AACD;;AAEDK,YAAsC;AACpC,WAAO,KAAKlB,OAAL,CAAakB,OAAb,EAAP;AACD;AA5CiE,C;SAA/CtB,W","file":"MongoCursor.js","sourcesContent":["import Cursor from 'mongodb/lib/cursor';\nimport MongoStore from './MongoStore';\nimport AbstractCursor from '../store/AbstractCursor';\nimport type { ResultType } from '../types';\n\nexport default class MongoCursor extends AbstractCursor<MongoStore> {\n  constructor(store: MongoStore, cursor: Cursor) {\n    super(store);\n    this._cursor = cursor;\n  }\n\n  advance(count: number): void {\n    this._cursor.skip(count);\n  }\n\n  next(): Promise<any> {\n    return this._cursor.next().then(value => {\n      this._result = value;\n      this.key = value && value._id;\n      return this.key;\n    });\n  }\n\n  limit(newLimit: number): Promise {\n    this._cursor.limit(newLimit);\n    return Promise.resolve(this);\n  }\n\n  count(applyLimit: boolean = false) {\n    return this._cursor.count(applyLimit);\n  }\n\n  result() {\n    return Promise.resolve(this._result);\n  }\n\n  close() {\n    if (this._cursor) {\n      this._cursor.close();\n      this._cursor = undefined;\n      this._store = undefined;\n      this._result = undefined;\n    }\n\n    return Promise.resolve();\n  }\n\n  toArray(): Promise<Array<ResultType>> {\n    return this._cursor.toArray();\n  }\n}\n"]}