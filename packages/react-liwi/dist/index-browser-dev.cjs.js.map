{"version":3,"file":"index-browser-dev.cjs.js","sources":["../src/reducer.ts","../src/hooks/useRetrieveResource.ts","../src/applyChanges.ts","../src/hooks/useRetrieveResourceAndSubscribe.ts","../src/hooks/useResources.ts","../src/hooks/useResource.ts"],"sourcesContent":["import { Reducer } from 'react';\n\nexport interface InitialState {\n  fetched: false;\n  promise: Promise<void>;\n}\n\nexport interface FetchedState<Result> {\n  fetched: true;\n  result: Result;\n}\n\nexport interface InitAction {\n  type: 'init';\n}\n\nexport interface ResolveAction<Result> {\n  type: 'resolve';\n  result: Result;\n}\n\nexport type Action<Result> = ResolveAction<Result>;\nexport type State<Result> = InitialState | FetchedState<Result>;\nexport type Reducer<Result> = Reducer<State<Result>, Action<Result>>;\n\nexport function initReducer(initializer: () => Promise<void>): InitialState {\n  return {\n    fetched: false,\n    promise: initializer(),\n  };\n}\n\nexport default function reducer<Result>(\n  state: State<Result>,\n  action: Action<Result>,\n): State<Result> {\n  switch (action.type) {\n    case 'resolve':\n      return {\n        fetched: true,\n        result: action.result,\n      };\n    default:\n      throw new Error('Invalid action');\n  }\n}\n","import { useReducer } from 'react';\nimport { BaseModel } from 'liwi-types';\nimport { AbstractQuery } from 'liwi-store';\nimport reducer, { initReducer, Reducer, State } from '../reducer';\n\nexport default function useRetrieveResource<Model extends BaseModel>(\n  createQuery: () => AbstractQuery<Model>,\n): State<Model[]> {\n  const [state, dispatch] = useReducer<Reducer<Model[]>, () => Promise<void>>(\n    reducer,\n    () =>\n      createQuery().fetch((result: Model[]) => {\n        dispatch({ type: 'resolve', result });\n      }),\n    initReducer,\n  );\n\n  return state;\n}\n","/* eslint-disable camelcase, complexity */\nimport { Change, Changes, QueryInfo } from 'liwi-types';\n\nconst copy = <Value>(state: Value[]): Value[] => state.slice();\n\nconst applyChange = <Value extends any>(\n  state: Value[],\n  change: Change<Value>,\n  queryInfo: QueryInfo,\n): Value[] => {\n  switch (change.type) {\n    case 'initial':\n      return change.initial;\n\n    case 'inserted': {\n      return [\n        ...change.objects,\n        ...(!queryInfo.limit ? state : state.slice(0, -queryInfo.limit)),\n      ];\n    }\n\n    case 'deleted': {\n      const keyPath = queryInfo.keyPath;\n      const deletedKeys = change.keys;\n      return state.filter((value) => !deletedKeys.includes(value[keyPath]));\n    }\n\n    case 'updated': {\n      const keyPath = queryInfo.keyPath;\n      const newState = copy(state);\n      change.objects.forEach((newObject) => {\n        const index = newState.findIndex(\n          (o: Value) => o[keyPath] === newObject[keyPath],\n        );\n        if (index === -1) return;\n        newState[index] = newObject;\n      });\n      return newState;\n    }\n\n    default:\n      throw new Error('Invalid type');\n  }\n};\n\n// https://github.com/rethinkdb/horizon/blob/next/client/src/ast.js\nexport default function applyChanges<Value>(\n  state: undefined | Value[],\n  changes: Changes<Value>,\n  queryInfo: QueryInfo,\n): undefined | Value[] {\n  if (state === undefined) return state;\n\n  return changes.reduce(\n    (stateValue: Value[], change: Change<Value>) =>\n      applyChange(stateValue, change, queryInfo),\n    state,\n  );\n}\n","/* eslint-disable @typescript-eslint/no-misused-promises */\nimport { useEffect, useReducer, useRef } from 'react';\nimport { BaseModel, Changes, InitialChange, QueryInfo } from 'liwi-types';\nimport { AbstractQuery, SubscribeResult } from 'liwi-store';\nimport Logger from 'nightingale-logger';\nimport applyChanges from '../applyChanges';\nimport reducer, { Reducer, initReducer } from '../reducer';\n\nexport interface UseResourceAndSubscribeOptions {\n  visibleTimeout: number;\n}\n\nconst defaultOptions = {\n  visibleTimeout: 1000 * 60 * 2, // 2 minutes\n};\n\nconst logger = new Logger('react-liwi:useResourceAndSubscribe');\n\nexport default function useRetrieveResourceAndSubscribe<\n  Model extends BaseModel\n>(\n  createQuery: () => AbstractQuery<Model>,\n  { visibleTimeout }: UseResourceAndSubscribeOptions = defaultOptions,\n) {\n  const subscribeResultRef = useRef<SubscribeResult<Model[]> | undefined>(\n    undefined,\n  );\n  const timeoutRef = useRef<ReturnType<typeof setTimeout> | undefined>(\n    undefined,\n  );\n  const resultRef = useRef<Model[] | undefined>(undefined);\n\n  const queryInfoRef = useRef<QueryInfo | undefined>(undefined);\n\n  const handleVisibilityChangeRef = useRef<any>(undefined);\n\n  const unsubscribe = (): void => {\n    logger.log('unsubscribe');\n\n    // reset timeout to allow resubscribing\n    timeoutRef.current = undefined;\n    resultRef.current = undefined;\n\n    if (subscribeResultRef.current) {\n      subscribeResultRef.current.stop();\n      subscribeResultRef.current = undefined;\n    }\n  };\n\n  const [state, dispatch] = useReducer<Reducer<Model[]>, () => Promise<void>>(\n    reducer,\n    () =>\n      new Promise((resolve, reject) => {\n        const query = createQuery();\n        const queryLogger = logger.context({\n          resourceName: (query as any).client.resourceName,\n          key: (query as any).key,\n        });\n        queryLogger.debug('init');\n\n        const subscribe = (): void => {\n          queryLogger.debug('subscribing', {\n            subscribeResultRef: subscribeResultRef.current,\n            timeoutRef: timeoutRef.current,\n          });\n          subscribeResultRef.current = query.fetchAndSubscribe(\n            (err: Error | null, changes: Changes<Model>) => {\n              queryLogger.debug('received changes', {\n                err,\n                changes,\n              });\n              if (err) {\n                // eslint-disable-next-line no-alert\n                alert(`Unexpected error: ${err}`);\n                return;\n              }\n\n              const currentResult = resultRef.current;\n\n              if (\n                !currentResult &&\n                changes.length === 1 &&\n                changes[0].type === 'initial'\n              ) {\n                const initialChange: InitialChange = changes[0] as InitialChange;\n                resultRef.current = initialChange.initial;\n                queryInfoRef.current = initialChange.queryInfo || {\n                  limit: undefined,\n                  keyPath: '_id',\n                };\n                dispatch({\n                  type: 'resolve',\n                  result: initialChange.initial,\n                });\n              } else {\n                const newResult = applyChanges(\n                  currentResult,\n                  changes,\n                  queryInfoRef.current as NonNullable<\n                    typeof queryInfoRef.current\n                  >,\n                );\n\n                if (newResult && newResult !== currentResult) {\n                  resultRef.current = newResult;\n                  dispatch({ type: 'resolve', result: newResult });\n                }\n              }\n            },\n          );\n        };\n\n        const handleVisibilityChange = () => {\n          if (!document.hidden) {\n            if (timeoutRef.current !== undefined) {\n              queryLogger.debug('timeout cleared');\n              clearTimeout(timeoutRef.current);\n              timeoutRef.current = undefined;\n            } else if (!subscribeResultRef.current) {\n              queryLogger.info('resubscribe');\n              subscribe();\n            }\n            return;\n          }\n\n          if (subscribeResultRef.current === undefined) return;\n\n          queryLogger.debug('timeout visible');\n          timeoutRef.current = setTimeout(unsubscribe, visibleTimeout);\n        };\n\n        handleVisibilityChangeRef.current = handleVisibilityChange;\n\n        document.addEventListener(\n          'visibilitychange',\n          handleVisibilityChange,\n          false,\n        );\n\n        if (!document.hidden) {\n          subscribe();\n        }\n      }),\n    initReducer,\n  );\n\n  useEffect(() => {\n    return () => {\n      if (handleVisibilityChangeRef.current) {\n        document.removeEventListener(\n          'visibilitychange',\n          handleVisibilityChangeRef.current,\n        );\n      }\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n        timeoutRef.current = undefined;\n      }\n\n      unsubscribe();\n    };\n  }, []);\n\n  return state;\n}\n","/* eslint-disable import/export */\n\nimport { POB_TARGET } from 'pob-babel';\nimport { AbstractQuery } from 'liwi-store';\nimport { BaseModel } from 'liwi-types';\nimport { InitialState, FetchedState } from '../reducer';\nimport useRetrieveResource from './useRetrieveResource';\nimport useRetrieveResourceAndSubscribe from './useRetrieveResourceAndSubscribe';\n\ntype CreateQuery<M extends BaseModel> = () => AbstractQuery<M>;\ntype UseResourceResult<Results> = [true, []] | [false, Results];\n\nexport default function useResources<T1 extends BaseModel>(\n  createQueries: [CreateQuery<T1>],\n  queriesToSubscribe: [boolean],\n): UseResourceResult<[T1[]]>;\nexport default function useResources<\n  T1 extends BaseModel,\n  T2 extends BaseModel\n>(\n  createQueries: [CreateQuery<T1>, CreateQuery<T2>],\n  queriesToSubscribe: [boolean, boolean],\n): UseResourceResult<[T1[], T2[]]>;\nexport default function useResources<\n  T1 extends BaseModel,\n  T2 extends BaseModel,\n  T3 extends BaseModel\n>(\n  createQueries: [CreateQuery<T1>, CreateQuery<T2>, CreateQuery<T3>],\n  queriesToSubscribe: [boolean, boolean, boolean],\n): UseResourceResult<[T1[], T2[], T3[]]>;\nexport default function useResources<\n  T1 extends BaseModel,\n  T2 extends BaseModel,\n  T3 extends BaseModel,\n  T4 extends BaseModel\n>(\n  createQueries: [\n    CreateQuery<T1>,\n    CreateQuery<T2>,\n    CreateQuery<T3>,\n    CreateQuery<T4>,\n  ],\n  queriesToSubscribe: [boolean, boolean, boolean, boolean],\n): UseResourceResult<[T1[], T2[], T3[], T4[]]>;\nexport default function useResources<\n  T1 extends BaseModel,\n  T2 extends BaseModel,\n  T3 extends BaseModel,\n  T4 extends BaseModel,\n  T5 extends BaseModel\n>(\n  createQueries: [\n    CreateQuery<T1>,\n    CreateQuery<T2>,\n    CreateQuery<T3>,\n    CreateQuery<T4>,\n    CreateQuery<T5>,\n  ],\n  queriesToSubscribe: [boolean, boolean, boolean, boolean, boolean],\n): UseResourceResult<[T1[], T2[], T3[], T4[], T5[]]>;\nexport default function useResources<T extends BaseModel>(\n  createQueries: (CreateQuery<T>)[],\n  queriesToSubscribe: boolean[],\n): UseResourceResult<T[][]> {\n  if (POB_TARGET === 'node') return [true, []];\n\n  const states = createQueries.map((createQuery, index) => {\n    return queriesToSubscribe[index]\n      ? // eslint-disable-next-line react-hooks/rules-of-hooks\n        useRetrieveResourceAndSubscribe(createQuery)\n      : // eslint-disable-next-line react-hooks/rules-of-hooks\n        useRetrieveResource(createQuery);\n  });\n\n  const nonFetchedStates: InitialState[] = states.filter(\n    (state) => !state.fetched,\n  ) as InitialState[];\n\n  if (nonFetchedStates.length !== 0) {\n    return [true, []];\n  }\n\n  return [false, states.map((state) => (state as FetchedState<any>).result)];\n}\n","import { POB_TARGET } from 'pob-babel';\nimport { AbstractQuery } from 'liwi-store';\nimport { BaseModel } from 'liwi-types';\nimport useRetrieveResource from './useRetrieveResource';\nimport useRetrieveResourceAndSubscribe, {\n  UseResourceAndSubscribeOptions,\n} from './useRetrieveResourceAndSubscribe';\n\ntype UseResourceResult<Result> = [true, undefined] | [false, Result];\n\nexport default function useResource<Model extends BaseModel>(\n  createQuery: () => AbstractQuery<Model>,\n  subscribe: boolean,\n  subscribeOptions?: UseResourceAndSubscribeOptions,\n): UseResourceResult<Model[]> {\n  if (POB_TARGET === 'node') return [true, undefined];\n\n  const state = subscribe\n    ? // eslint-disable-next-line react-hooks/rules-of-hooks\n      useRetrieveResourceAndSubscribe<Model>(createQuery, subscribeOptions)\n    : // eslint-disable-next-line react-hooks/rules-of-hooks\n      useRetrieveResource<Model>(createQuery);\n\n  if (!state.fetched) {\n    return [true, undefined];\n  }\n\n  return [false, state.result];\n}\n"],"names":["initReducer","initializer","fetched","promise","reducer","state","action","type","result","Error","useRetrieveResource","createQuery","useReducer","fetch","dispatch","copy","slice","applyChange","change","queryInfo","initial","objects","limit","keyPath","deletedKeys","keys","filter","value","includes","newState","forEach","newObject","index","findIndex","o","applyChanges","changes","undefined","reduce","stateValue","defaultOptions","visibleTimeout","logger","Logger","useRetrieveResourceAndSubscribe","subscribeResultRef","useRef","timeoutRef","resultRef","queryInfoRef","handleVisibilityChangeRef","unsubscribe","log","current","stop","Promise","query","queryLogger","context","resourceName","client","key","debug","subscribe","fetchAndSubscribe","err","alert","currentResult","length","initialChange","newResult","handleVisibilityChange","document","hidden","clearTimeout","info","setTimeout","addEventListener","useEffect","removeEventListener","useResources","createQueries","queriesToSubscribe","states","map","nonFetchedStates","useResource","subscribeOptions"],"mappings":"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"}