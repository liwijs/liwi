{"version":3,"file":"index-browser-dev.es.js","sources":["../src/Find.ts","../src/index.ts"],"sourcesContent":["import React, { Component, ReactNode, ComponentType } from 'react';\nimport { AbstractQuery, AbstractStore } from 'liwi-store';\n\ninterface LoadingProps {}\n\ntype Record<K extends string, T> = { [P in K]: T };\n\ninterface Props<\n  Name extends string,\n  Result extends any,\n  Store extends AbstractStore<any, any, any, any>\n> {\n  component: ComponentType<Record<Name, Result>>;\n  loadingComponent?: ComponentType<LoadingProps>;\n  name: Name;\n  query: AbstractQuery<Store>;\n}\n\ninterface State<Result> {\n  fetched: boolean;\n  result: Result | undefined;\n}\n\nexport default class FindComponent<\n  Name extends string,\n  Result extends any,\n  Model,\n  Store extends AbstractStore<any, any, any, any>\n> extends Component<Props<Name, Result, Store>, State<Result>> {\n  state = {\n    fetched: false,\n    result: undefined,\n  };\n\n  // eslint-disable-next-line react/sort-comp\n  _find?: Promise<void>;\n\n  componentDidMount() {\n    const { query } = this.props;\n    this._find = query.fetch((result: Result) => {\n      if (!this._find) return;\n      this.setState({\n        fetched: true,\n        result,\n      });\n      delete this._find;\n    });\n  }\n\n  componentWillUnmount() {\n    if (this._find) {\n      // this._find.cancel();\n      delete this._find;\n    }\n  }\n\n  render(): ReactNode {\n    if (!this.state.fetched) {\n      return this.props.loadingComponent\n        ? React.createElement(this.props.loadingComponent)\n        : null;\n    }\n\n    return React.createElement(this.props.component, {\n      [this.props.name]: this.state.result,\n    } as any);\n  }\n}\n","export { default as Find } from './Find';\n// export { default as FindAndSubscribe } from './FindAndSubscribe';\n"],"names":["FindComponent","state","fetched","result","undefined","_find","componentDidMount","query","props","fetch","setState","componentWillUnmount","render","loadingComponent","React","createElement","component","name","Component"],"mappings":";;;;;;;;IAuBqBA;;;;;;;;;;;;;UAMnBC,QAAQ;MACNC,OAAO,EAAE,KADH;MAENC,MAAM,EAAEC;;UAIVC;;;;;;SAEAC,iDAAoB;;;QACVC,KADU,GACA,KAAKC,KADL,CACVD,KADU;SAEbF,KAAL,GAAaE,KAAK,CAACE,KAAN,CAAY,UAACN,MAAD,EAAoB;UACvC,CAAC,MAAI,CAACE,KAAV,EAAiB;;MACjB,MAAI,CAACK,QAAL,CAAc;QACZR,OAAO,EAAE,IADG;QAEZC,MAAM,EAANA;OAFF;;aAIO,MAAI,CAACE,KAAZ;KANW,CAAb;;;SAUFM,uDAAuB;QACjB,KAAKN,KAAT,EAAgB;;aAEP,KAAKA,KAAZ;;;;SAIJO,2BAAoB;;;QACd,CAAC,KAAKX,KAAL,CAAWC,OAAhB,EAAyB;aAChB,KAAKM,KAAL,CAAWK,gBAAX,GACHC,KAAK,CAACC,aAAN,CAAoB,KAAKP,KAAL,CAAWK,gBAA/B,CADG,GAEH,IAFJ;;;WAKKC,KAAK,CAACC,aAAN,CAAoB,KAAKP,KAAL,CAAWQ,SAA/B,mDACJ,KAAKR,KAAL,CAAWS,IADP,IACc,KAAKhB,KAAL,CAAWE,MADzB,wBAAP;;;;EAnCMe;;AC3BV;;;;"}