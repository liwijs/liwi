{"version":3,"sources":["../../src/rest/RestService.js"],"names":["RestCursor","RestService","constructor","restResources","Map","addRestResource","key","restResource","set","get","Error","createCursor","restName","connectedUser","criteria","sort","limit","cursor","store"],"mappings":";;;;AAAA,OAAOA,UAAP,MAAuB,cAAvB;;AAEA,eAAe,MAAMC,WAAN,CAAkB;AAC/BC,cAAYC,aAAZ,EAAgC;AAAA,YAApBA,aAAoB,EAALC,GAAK;;AAC9B,SAAKD,aAAL,GAAqBA,aAArB;AACD;;AAEDE,kBAAgBC,GAAhB,EAA6BC,YAA7B,EAA2C;AAAA,YAA3BD,GAA2B;;AACzC,SAAKH,aAAL,CAAmBK,GAAnB,CAAuBF,GAAvB,EAA4BC,YAA5B;AACD;;AAEDE,MAAIH,GAAJ,EAAiB;AAAA,YAAbA,GAAa;;AACf,QAAMC,eAAe,KAAKJ,aAAL,CAAmBM,GAAnB,CAAuBH,GAAvB,CAArB;AACA,QAAI,CAACC,YAAL,EAAmB,MAAM,IAAIG,KAAJ,CAAW,4BAA0BJ,GAAI,IAAzC,CAAN;AACnB,WAAOC,YAAP;AACD;;AAEKI,cAAN,CACMC,QADN,EAEMC,aAFN,QAIa;AAAA,QADLC,QACK,QADLA,QACK;AAAA,QADKC,IACL,QADKA,IACL;AAAA,QADWC,KACX,QADWA,KACX;;AAAA,YAHPJ,QAGO;;AAAA,YAFPC,aAEO;;AAAA;AADLC,cACK;AADKC,UACL;AADWC;AACX;AADsBF,cACtB;AADyCC,UACzC;AADwDC,WACxD;AAAA;;AAAA;AACX,UAAMT,eAAe,KAAKE,GAAL,CAASG,QAAT,CAArB;AACAE,iBAAWP,aAAaO,QAAb,CAAsBD,aAAtB,EAAqCC,YAAY,EAAjD,CAAX;AACAC,aAAOR,aAAaQ,IAAb,CAAkBF,aAAlB,EAAiCE,IAAjC,CAAP;AACA,UAAME,SAAS,MAAMV,aAAaW,KAAb,CAAmBD,MAAnB,CAA0BH,QAA1B,EAAoCC,IAApC,CAArB;AACAC,cAAQT,aAAaS,KAAb,CAAmBA,KAAnB,CAAR;AACA,UAAIA,KAAJ,EAAWC,OAAOD,KAAP,CAAaH,aAAb,EAA4BG,KAA5B;AACX,aAAO,IAAIhB,UAAJ,CAAeO,YAAf,EAA6BM,aAA7B,EAA4CI,MAA5C,CAAP;AAPW;AAQZ;AA3B8B","file":"RestService.js","sourcesContent":["import RestCursor from './RestCursor';\n\nexport default class RestService {\n  constructor(restResources: Map) {\n    this.restResources = restResources;\n  }\n\n  addRestResource(key: string, restResource) {\n    this.restResources.set(key, restResource);\n  }\n\n  get(key: string) {\n    const restResource = this.restResources.get(key);\n    if (!restResource) throw new Error(`Invalid rest resource: \"${key}\"`);\n    return restResource;\n  }\n\n  async createCursor(\n        restName: string,\n        connectedUser: ?Object,\n        { criteria, sort, limit }: { criteria: ?Object, sort: ?Object, limit: ?number },\n    ): Promise {\n    const restResource = this.get(restName);\n    criteria = restResource.criteria(connectedUser, criteria || {});\n    sort = restResource.sort(connectedUser, sort);\n    const cursor = await restResource.store.cursor(criteria, sort);\n    limit = restResource.limit(limit);\n    if (limit) cursor.limit(connectedUser, limit);\n    return new RestCursor(restResource, connectedUser, cursor);\n  }\n}\n"]}